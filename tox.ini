[tox]
envlist = py27,py37,py38,py39

[testenv]
deps =
    -rtest-requirements.txt
commands =
    pytest -vv \
    --cov-config .coveragerc --cov=pubtools --cov-report term \
    --cov-report xml --cov-report html {posargs}

whitelist_externals = sh

[testenv:py27]
deps =
    -rrequirements-test.txt
    -clegacy.constraints

[pytest]
testpaths = tests

[testenv:docs]
basepython = python3
deps =
    docutils==0.16
    Sphinx
    sphinx_rtd_theme
    sphinx-argparse
    paramiko
commands = python setup.py build_sphinx

[testenv:flake8]
description = PEP8 checks
basepython = python3
deps =
    flake8
    flake8-docstrings
commands =
    flake8 pubtools tests

[flake8]
ignore = D100,D104,W503
max-line-length = 100
per-file-ignores =
    tests/*:D103
# "D401 First line should be in imperative mood" -> hooks are not like typical functions
    pubtools/_content_gateway/hooks.py:D401